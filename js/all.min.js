function getLocation(){function e(e){currentLocationLatitude=e.coords.latitude,currentLocationLongitude=e.coords.longitude,currentMarker()}function o(e){var o={0:"不明原因錯誤",1:"使用者拒絕提供位置資訊",2:"無法取得位置資訊",3:"位置查詢逾時"};alert(o[e.code]),console.log("code="+e.code+" "+e.message)}if(navigator.geolocation){var t={enableAcuracy:!1,maximumAge:0,timeout:6e5};navigator.geolocation.getCurrentPosition(e,o,t)}else alert("此瀏覽器不支援地理定位功能!")}function initMap(){var e={center:{lat:currentLocationLatitude,lng:currentLocationLongitude},zoom:17,mapTypeId:google.maps.MapTypeId.ROADMAP};map=new google.maps.Map(document.getElementById("map"),e),getLocation()}function currentMarker(){var e=new GeolocationMarker(map);e.setCircleOptions({fillColor:"#808080"}),google.maps.event.addListenerOnce(e,"position_changed",function(){map.setCenter(this.getPosition())}),google.maps.event.addListener(e,"geolocation_error",function(e){alert("無法取得位置資訊. "+e.message)}),e.setMap(map)}Parse.initialize("5fzYdG6YMpMPKBNSqvzhEL1OVoXgcVvlCAghW09Q","NK9ycOzWNik9d6axOAndjYXwRuycfX2qTIyidyxV");var defaultLocationLatitude=25.0339031,defaultLocationLongitude=121.5645098,currentLocationLatitude=defaultLocationLatitude,currentLocationLongitude=defaultLocationLongitude,map,mc,result=[],processCallback=function(e){if(result=result.concat(e),1e3==e.length)return void process(e[e.length-1].id);for(var o=0;o<result.length;o++)addMarker(result[o]);mc=new MarkerClusterer(map,markers,{gridSize:80,maxZoom:14})},process=function(e){var o=new Parse.Query("TPE100415");e&&o.greaterThan("objectId",e),o.limit(1e3),o.ascending("objectId"),o.find().then(function(e){processCallback(e)},function(e){console.log("Error: "+e.code+" "+e.message)})};process(!1);var markers=[],image="img/pin.png";google.maps.InfoWindow.prototype.isOpen=function(){var e=this.getMap();return null!==e&&"undefined"!=typeof e};var addMarker=function(e){var o=new google.maps.Marker({position:new google.maps.LatLng(e.get("location").latitude,e.get("location").longitude),map:map,title:e.get("road")+e.get("address"),icon:image});o.infowindow=new google.maps.InfoWindow({content:"<h4>"+e.get("region")+'</h4><p><img src="https://maps.googleapis.com/maps/api/streetview?size=400x180&location='+e.get("location").latitude+","+e.get("location").longitude+'&fov=90&heading=180&pitch=10"></p><h4>'+e.get("road")+e.get("address")+"</h4>"}),markers.push(o),google.maps.event.addListener(o,"click",function(e){map.panTo(this.position);for(var t=0;t<markers.length;t++)markers[t].infowindow.isOpen()&&markers[t].infowindow.close();this.infowindow.open(map,o)})};
//# sourceMappingURL=all.min.js.map