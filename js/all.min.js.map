{"version":3,"sources":["main.js"],"names":["initMap","mapOptions","center","lat","lng","zoom","mapTypeId","google","maps","MapTypeId","ROADMAP","map","Map","document","getElementById","Parse","initialize","mc","result","processCallback","res","concat","length","process","id","console","log","i","addMarker","MarkerClusterer","markers","gridSize","maxZoom","skip","query","Query","greaterThan","limit","ascending","find","then","error","code","message","data","marker","Marker","position","LatLng","get","latitude","longitude","title","infowindow","InfoWindow","content","push","event","addListener","e","panTo","this","open"],"mappings":"AASA,QAAAA,WAEA,GAAAC,IACAC,QAAAC,IAAA,WAAAC,IAAA,aACAC,KAAA,GACAC,UAAAC,OAAAC,KAAAC,UAAAC,QAGAC,KAAA,GAAAJ,QAAAC,KAAAI,IAAAC,SAAAC,eAAA,OAAAb,GAdAc,MAAAC,WAAA,2CAAA,2CAKA,IAAAL,KAcAM,GACAC,UACAC,gBAAA,SAAAC,GAEA,GADAF,OAAAA,OAAAG,OAAAD,GACA,KAAAA,EAAAE,OAEA,WADAC,SAAAH,EAAAA,EAAAE,OAAA,GAAAE,GAGAC,SAAAC,IAAAR,OAAAI,OAGA,KAAA,GAAAK,GAAA,EAAAA,EAAAT,OAAAI,OAAAK,IAEAC,UAAAV,OAAAS,GAGAV,IAAA,GAAAY,iBAAAlB,IAAAmB,SAAAC,SAAA,GAAAC,QAAA,MAIAT,QAAA,SAAAU,GACA,GAAAC,GAAA,GAAAnB,OAAAoB,MAAA,YAEAF,IACAC,EAAAE,YAAA,WAAAH,GAEAC,EAAAG,MAAA,KACAH,EAAAI,UAAA,YACAJ,EAAAK,OAAAC,KAAA,SAAApB,GACAD,gBAAAC,IACA,SAAAqB,GACAhB,QAAAC,IAAA,UAAAe,EAAAC,KAAA,IAAAD,EAAAE,WAGApB,UAAA,EAWA,IAAAO,YACAF,UAAA,SAAAgB,GACA,GAAAC,GAAA,GAAAtC,QAAAC,KAAAsC,QACAC,SAAA,GAAAxC,QAAAC,KAAAwC,OAAAJ,EAAAK,IAAA,YAAAC,SAAAN,EAAAK,IAAA,YAAAE,WACAxC,IAAAA,IACAyC,MAAAR,EAAAK,IAAA,QAAAL,EAAAK,IAAA,YAGAJ,GAAAQ,WAAA,GAAA9C,QAAAC,KAAA8C,YACAC,QAAA,OAAAX,EAAAK,IAAA,QAAAL,EAAAK,IAAA,WAAA,2FAEAL,EAAAK,IAAA,YAAAC,SAAA,IAAAN,EAAAK,IAAA,YAAAE,UAAA,uCAIArB,QAAA0B,KAAAX,GAEAtC,OAAAC,KAAAiD,MAAAC,YAAAb,EAAA,QAAA,SAAAc,GACAhD,IAAAiD,MAAAC,KAAAd,UAGAc,KAAAR,WAAAS,KAAAnD,IAAAkC","file":"all.min.js","sourcesContent":["\n//initialize\n//Parse.$ = jQuery;\nParse.initialize('5fzYdG6YMpMPKBNSqvzhEL1OVoXgcVvlCAghW09Q', 'NK9ycOzWNik9d6axOAndjYXwRuycfX2qTIyidyxV');\n\n//Get user location HTML5 >> if no location, set default location\n\n\nvar map;\nfunction initMap() {\n\n  var mapOptions = {\n     center: {lat: 25.0339031, lng: 121.5645098},\n      zoom: 17,\n      mapTypeId: google.maps.MapTypeId.ROADMAP\n  };\n\n  map = new google.maps.Map(document.getElementById(\"map\"), mapOptions);\n\n}\n\n\nvar mc;\nvar result = [];\nvar processCallback = function(res) {\n                result = result.concat(res);\n                if (res.length == 1000) {\n                  process(res[res.length-1].id);\n                  return;\n                }   \n                console.log(result.length);\n\n                //To print all results\n                for(var i=0;i<result.length;i++){\n                        //console.log(result[i].id);\n                        addMarker(result[i]);\n                }\n\n                mc = new MarkerClusterer(map, markers, {gridSize: 80, maxZoom: 16});\n\n}\n\nvar process = function(skip) {\n    var query = new Parse.Query(\"TPE201509\");\n\n            if (skip) {\n              query.greaterThan(\"objectId\", skip);\n            }\n            query.limit(1000);\n            query.ascending(\"objectId\");\n            query.find().then(function querySuccess(res) {\n                processCallback(res);\n            }, function queryFailed(error) {\n                console.log('Error: ' + error.code + ' ' + error.message);\n            });\n}\nprocess(false);\n\n//\n\n/*\ngoogle.maps.InfoWindow.prototype.isOpen = function(){\n  var map = this.getMap();\n  return (map !== null && typeof map !== \"undefined\");\n}*/\n\n\nvar markers = [];\nvar addMarker = function(data){\n  var marker = new google.maps.Marker({\n        position : new google.maps.LatLng(data.get('location').latitude, data.get('location').longitude), \n        map : map,\n        title : data.get('road') + data.get('address')\n  });\n\n  marker.infowindow = new google.maps.InfoWindow({\n      content: '<h3>' + data.get('road') + data.get('address') + '</h3>'\n          + '<p><img src=\"https://maps.googleapis.com/maps/api/streetview?size=200x180&location='\n          + data.get('location').latitude +','+data.get('location').longitude+'&fov=90&heading=180&pitch=10\"></p>'\n          \n  });\n\n  markers.push(marker);\n\n  google.maps.event.addListener(marker, 'click', function(e){\n      map.panTo( this.position );\n      //map.setZoom(17);\n      //for (var i = 0; i < markers.length; i++) { if(markers[i].infowindow.isOpen()){ markers[i].infowindow.close(); } }\n      this.infowindow.open(map, marker);\n  });\n};\n\n\n"],"sourceRoot":"/source/"}